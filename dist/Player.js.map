{"version":3,"sources":["../src/Player.ts"],"names":["Player","constructor","id","name","socket","secret","crypto","randomBytes","toString","gameData","GameData","parseAuthString","authString","segments","split","length","forPublic","data","leader","lobby","Object","assign","forFinalScoreboard","emit","event","on","handler","PlayerEventRemover","once","off"],"mappings":";;;;;;;AACA;;AAIA;;AACA;;AAEA;;;;AAEe,MAAMA,MAAN,CAAa;AAapBC,EAAAA,WAAP,CAAmBC,EAAnB,EAA+BC,IAA/B,EAA6CC,MAA7C,EAA6D;AAC5D,SAAKF,EAAL,GAAUA,EAAV;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACA,SAAKE,MAAL,GAAcC,gBAAOC,WAAP,CAAmB,EAAnB,EAAuBC,QAAvB,CAAgC,KAAhC,CAAd;AACA,SAAKJ,MAAL,GAAcA,MAAd;AACA,SAAKK,QAAL,GAAgB,IAAIC,iBAAJ,EAAhB;AAEA,uBAAK,IAAL,EAAW,KAAKR,EAAhB;AACA;;AAED,SAAcS,eAAd,CAA8BC,UAA9B,EAAoE;AACnE,QAAI,OAAOA,UAAP,KAAsB,QAA1B,EAAoC,OAAO,IAAP;AAEpC,UAAMC,QAAQ,GAAGD,UAAU,CAACE,KAAX,CAAiB,GAAjB,CAAjB;AAEA,WAAQD,QAAQ,CAACE,MAAT,KAAoB,CAArB,GACJ;AAAEb,MAAAA,EAAE,EAAEW,QAAQ,CAAC,CAAD,CAAd;AAAmBR,MAAAA,MAAM,EAAEQ,QAAQ,CAAC,CAAD;AAAnC,KADI,GAEJ,IAFH;AAGA;;AAED,MAAWD,UAAX,GAAiC;AAChC,WAAQ,GAAE,KAAKV,EAAG,IAAG,KAAKG,MAAO,EAAjC;AACA;;AAED,MAAWW,SAAX,GAAgC;AAC/B,QAAIC,IAAI,GAAG;AACVf,MAAAA,EAAE,EAAE,KAAKA,EADC;AAEVC,MAAAA,IAAI,EAAE,KAAKA,IAFD;AAGVe,MAAAA,MAAM,EAAE,KAAKC,KAAL,CAAWD,MAAX,KAAsB;AAHpB,KAAX;AAMA,WAAQ,KAAKT,QAAN,GACJW,MAAM,CAACC,MAAP,CAAcJ,IAAd,EAAoB,KAAKR,QAAL,CAAcO,SAAlC,CADI,GAEJC,IAFH;AAGA;;AAED,MAAWK,kBAAX,GAAyC;AACxC,QAAIL,IAAI,GAAG,KAAKD,SAAhB;AAEA,WAAQ,KAAKP,QAAN,GACJW,MAAM,CAACC,MAAP,CAAcJ,IAAd,EAAoB,KAAKR,QAAL,CAAca,kBAAlC,CADI,GAEJL,IAFH;AAGA;;AAEMM,EAAAA,IAAP,CAAYC,KAAZ,EAA2BP,IAA3B,EAA8C;AAC7C,SAAKb,MAAL,CAAYmB,IAAZ,CAAiBC,KAAjB,EAAwBP,IAAxB;AAEA,WAAO,IAAP;AACA;;AAEMQ,EAAAA,EAAP,CAAUD,KAAV,EAAyBE,OAAzB,EAA6D;AAC5D,SAAKtB,MAAL,CAAYqB,EAAZ,CAAeD,KAAf,EAAsBE,OAAtB;AAEA,WAAO,IAAIC,2BAAJ,CAAuB,IAAvB,EAA6BD,OAA7B,CAAP;AACA;;AAEME,EAAAA,IAAP,CAAYJ,KAAZ,EAA2BE,OAA3B,EAAiD;AAChD,SAAKtB,MAAL,CAAYwB,IAAZ,CAAiBJ,KAAjB,EAAwBE,OAAxB;AAEA,WAAO,IAAP;AACA;;AAEMG,EAAAA,GAAP,CAAWL,KAAX,EAA0BE,OAA1B,EAAgD;AAC/C,SAAKtB,MAAL,CAAYyB,GAAZ,CAAgBL,KAAhB,EAAuBE,OAAvB;AAEA,WAAO,IAAP;AACA;;AA/E0B","sourcesContent":["import Socket from 'socket.io/lib/socket'\nimport crypto from 'crypto'\n\nimport AuthInfo from './Contracts/AuthInfo'\nimport Lobby from './Lobby'\nimport PlayerEventRemover from './PlayerEventRemover'\nimport GameData from './Games/GameData'\n\nimport { info } from 'helpers'\n\nexport default class Player {\n\tpublic id: string\n\n\tpublic name: string\n\n\tpublic lobby: Lobby\n\n\tpublic socket: Socket\n\n\tpublic secret: string\n\n\tpublic gameData: GameData\n\n\tpublic constructor(id: string, name: string, socket: Socket) {\n\t\tthis.id = id\n\t\tthis.name = name\n\t\tthis.secret = crypto.randomBytes(16).toString('hex')\n\t\tthis.socket = socket\n\t\tthis.gameData = new GameData()\n\n\t\tinfo('P+', this.id)\n\t}\n\n\tpublic static parseAuthString(authString: string) : AuthInfo | null {\n\t\tif (typeof authString !== 'string') return null\n\n\t\tconst segments = authString.split(';')\n\n\t\treturn (segments.length === 2)\n\t\t\t? { id: segments[0], secret: segments[1] }\n\t\t\t: null\n\t}\n\n\tpublic get authString() : string {\n\t\treturn `${this.id};${this.secret}`\n\t}\n\n\tpublic get forPublic() : object {\n\t\tlet data = {\n\t\t\tid: this.id,\n\t\t\tname: this.name,\n\t\t\tleader: this.lobby.leader === this,\n\t\t}\n\n\t\treturn (this.gameData)\n\t\t\t? Object.assign(data, this.gameData.forPublic)\n\t\t\t: data\n\t}\n\n\tpublic get forFinalScoreboard() : object {\n\t\tlet data = this.forPublic\n\n\t\treturn (this.gameData)\n\t\t\t? Object.assign(data, this.gameData.forFinalScoreboard)\n\t\t\t: data\n\t}\n\n\tpublic emit(event: string, data?: any) : this {\n\t\tthis.socket.emit(event, data)\n\n\t\treturn this\n\t}\n\n\tpublic on(event: string, handler?: any) : PlayerEventRemover {\n\t\tthis.socket.on(event, handler)\n\n\t\treturn new PlayerEventRemover(this, handler)\n\t}\n\n\tpublic once(event: string, handler?: any) : this {\n\t\tthis.socket.once(event, handler)\n\n\t\treturn this\n\t}\n\n\tpublic off(event: string, handler?: any) : this {\n\t\tthis.socket.off(event, handler)\n\n\t\treturn this\n\t}\n}\n"],"file":"Player.js"}